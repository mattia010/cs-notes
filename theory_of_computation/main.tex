\documentclass[nobib, oneside, openany]{tufte-book}
% nobib     =   do not use package natbib, default in tufte-book.
%               it conflicts with biblatex.
% oneside   =   no blank page between chap and page do not move
%               left or right based on the page number.
% openany   =

% ------------------------------------
% |            GEOMETRY              |
% ------------------------------------
\setcounter{tocdepth}{2}
\setcounter{secnumdepth}{2}

\makeatletter
% Paragraph indentation and separation for normal text
\renewcommand{\@tufte@reset@par}{
    \setlength{\RaggedRightParindent}{0pt}
    \setlength{\JustifyingParindent}{0pt}
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{4pt}
}
\@tufte@reset@par

% Paragraph indentation and separation for marginal text
\renewcommand{\@tufte@margin@par}{
    \setlength{\RaggedRightParindent}{0pt}
    \setlength{\JustifyingParindent}{0pt}
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{4pt}
}


\makeatletter
\renewcommand{\maketitlepage}{
    \begingroup
        \setlength{\parindent}{0pt}
            {\fontsize{24}{24}\selectfont\textit{\@author}\par}
        \vspace{1.75in}
            {\fontsize{36}{54}\selectfont\@title\par}
        \vspace{0.5in}
            {\fontsize{14}{14}\selectfont\textsf{\smallcaps{\@date}}\par}
        \vfill{\fontsize{14}{14}\selectfont\textit{\@publisher}\par}
        \thispagestyle{empty}
    \endgroup
}
\makeatother

\geometry{
    %showframe,             % DEBUG ONLY -- displays the margins
	left=13mm,              % left margin
	textwidth=135mm,        % width of main text
	marginparsep=8mm,       % gutter between main text block and margin notes
	marginparwidth=50mm     % width of margin notes
}
\fontsize{10}{20}\selectfont

% chapter format
\titleformat{\chapter}
    {\huge\rmfamily\itshape\color{red}}             % format applied to label+text
    {\llap{\colorbox{red}{\parbox{1.5cm}{\hfill\itshape\huge\color{white}\thechapter}}}}
    {2pt}   % horizontal separation between label and title body
    {}      % before the title body
    []      % after the title body

% section format
\titleformat{\section}
    {\normalfont\Large\itshape\color{orange}}       % format applied to label+text
    {\llap{\colorbox{orange}{\parbox{1.5cm}{\hfill\color{white}\thesection}}}}
    {1em}   % horizontal separation between label and title body
    {}      % before the title body
    []      % after the title body

% subsection format
\titleformat{\subsection}
    {\normalfont\large\itshape\color{blue}}% format applied to label+text
    {\llap{\colorbox{blue}{\parbox{1.5cm}{\hfill\color{white}\thesubsection}}}}
    {1em}   % horizontal separation between label and title body
    {}      % before the title body
    []      % after the title body

% ------------------------------------
% |        GENERIC PACKAGES          |
% ------------------------------------
% Math
\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{relsize, xfrac}

% Pseudocode
\usepackage{clrscode3e}         % Pseudocode as in "Introduction to algorithms"
\usepackage{minted}             % Code highlighting

% Hyperlinks in PDFs
\usepackage{hyperref}

% Lorem Ipsum text
\usepackage{lipsum}

% Images
\usepackage{graphicx}
\setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio}
\graphicspath{/images}

% Verb environment
\usepackage{fancyvrb}           % Customization of verb environments.
\fvset{fontsize=\normalsize}    % Use a smaller font for the verb environment.

% Language
\usepackage[italian]{babel}

% Bibliography
\usepackage{csquotes}
\usepackage[
    backend=biber,
    style=alphabetic,
    sorting=ynt
]{biblatex}
\addbibresource{bib/bibliography.bib}

% Filter out some warning
\usepackage{silence}
  \WarningFilter*{latex}
    {Marginpar on page \thepage\space moved}
  \WarningFilter{biblatex}          % ONLY IF BIBLATEX DOES NOT USE IBID STYLE REF.
    {Patching footnote}

% IDK
\usepackage{booktabs}               % Makes prettier tables.
\usepackage{multicol}               % Small sections of multiple columns in
                                    % documents and tables.

\usepackage{bookmark}
\usepackage[
    activate={true,nocompatibility},
    final,
    tracking=true,
    nopatch=footnote,
    kerning=true,
    spacing=false,
    factor=1100,
    stretch=10,
    shrink=10
]{microtype}

\usepackage{pgf,tikz,tikz-cd}

\usepackage{fancyhdr}               % Custom headers and footers.
\pagestyle{fancyplain}              % Makes all pages in the document conform
                                    % to the custom headers and footers.
\fancyhead{}                        % No page header - if you want one, create
                                    % it in the same way as the footers below.
\fancyfoot[L]{}                     % Empty left footer.
\fancyfoot[C]{}                     % Empty center footer.
\fancyfoot[R]{\thepage}             % Page numbering for right footer.
\renewcommand{\headrulewidth}{0pt}  % Remove header underlines.
\renewcommand{\footrulewidth}{0pt}  % Remove footer underlines.
\setlength{\headheight}{13.6pt}     % Customize the height of the header.
\allowdisplaybreaks

\usepackage{tabularx,environ} % For problem definition


% ------------------------------------
% |      THEOREM ENVIRONMENTS        |
% ------------------------------------
\newtheorem{thm}{Theorem}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{quest}[thm]{Question}
\newtheorem{claim}{Claim}
\newtheorem{property}{Proprietà}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{defns}[thm]{Definitions}
\newtheorem{con}[thm]{Construction}
\newtheorem{exmp}[thm]{Example}
\newtheorem{exmps}[thm]{Examples}
\newtheorem{notn}[thm]{Notation}
\newtheorem{notns}[thm]{Notations}
\newtheorem{addm}[thm]{Addendum}
\newtheorem{exer}[thm]{Exercise}

\theoremstyle{remark}
\newtheorem{rem}[thm]{Osservazione}
\newtheorem{ans}[thm]{Answer}
\newtheorem{rems}[thm]{Remarks}
\newtheorem{warn}[thm]{Warning}
\newtheorem{sch}[thm]{Scholium}

% ------------------------------------
% |       COMMAND DEFINITIONS        |
% ------------------------------------
% Operators
\newcommand{\Mod}[1]{\ (\text{mod}\ #1)}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\OR}{\,|\,}
\newcommand{\AND}{\,\&\,}
\newcommand{\NOT}{!}

% Parenthesis
\newcommand{\bra}[1]{\left(#1\right)}
\newcommand{\sbra}[1]{\left[#1\right]}
\newcommand{\cbra}[1]{\left\{#1\right\}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\ang}[1]{\left\langle#1\right\rangle}

% Shortened versions
\newcommand{\tn}[1]{\textnormal{#1}}

% Other
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\newcommand{\upperAccE}{È \,}

% ------------------------------------
% |    DOCUMENT-SPECIFIC PACKAGES    |
% ------------------------------------

% ------------------------------------
% |    DOCUMENT-SPECIFIC COMMANDS    |
% ------------------------------------

% Abbreviations for pattern matching
\newcommand{\occ}{\tn{Occ}}
\newcommand{\bwt}{\tn{BWT}}
\newcommand{\lf}{\tn{LF}}

% Cost function for approx algorithms
\newcommand{\opt}{\tn{opt}}
\newcommand{\appr}{\tn{A}}

% ------------------------------------
% |  DOCUMENT-SPECIFIC ENVIRONMENTS  |
% ------------------------------------
\makeatletter           % https://tex.stackexchange.com/a/199244/26355
\newcolumntype{\expand}{}
\long\@namedef{NC@rewrite@\string\expand}{\expandafter\NC@find}
\NewEnviron{problem}[2][]{%
    \def\problem@arg{#1}%
    \def\problem@framed{framed}%
    \def\problem@lined{lined}%
    \def\problem@doublelined{doublelined}%
    \ifx\problem@arg\@empty%
        \def\problem@hline{}%
    \else%
        \ifx\problem@arg\problem@doublelined%
        \def\problem@hline{\hline\hline}%
        \else%
        \def\problem@hline{\hline}%
        \fi%
    \fi%
    \ifx\problem@arg\problem@framed%
        \def\problem@tablelayout{|>{\bfseries}lX|c}%
        \def\problem@title{\multicolumn{2}{|%
        >{\raisebox{-\fboxsep}}%
        p{\dimexpr\textwidth-4\fboxsep-2\arrayrulewidth\relax}%
        |}{%
            \textsc{\Large #2}%
        }}%
    \else
        \def\problem@tablelayout{>{\bfseries}lXc}%
        \def\problem@title{\multicolumn{2}{>%
        {\raisebox{-\fboxsep}}%
        p{\dimexpr\textwidth-4\fboxsep\relax}%
        }{%
            \textsc{\Large #2}%
        }}%
    \fi%
    \bigskip\par\noindent%
    \renewcommand{\arraystretch}{1.2}%
    \begin{tabularx}{\textwidth}{\expand\problem@tablelayout}%
        \problem@hline%
        \problem@title\\[2\fboxsep]%
        \BODY\\\problem@hline%
    \end{tabularx}%
    \medskip\par%
}
\makeatother


% ------------------------------------
% |         Main section             |
% ------------------------------------
\title{Teoria della\\Computazione}
\author{Mattia Bolognini}
\date{Ultima modifica: \today}

\begin{document}

\maketitle

\tableofcontents

\input{chap/teoria_computabilità}
\input{chap/teoria_complessità}
\input{chap/algo_approx}
\input{chap/algo_parametrici}


\end{document}
